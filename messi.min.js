!function(){"use strict";function s(i,t){var o,e=this;if(e.options=jQuery.extend({},s.prototype.options,t||{}),e.messi=jQuery(e.template),e.setContent(i),null===e.options.title?jQuery(".messi-titlebox",e.messi).remove():(jQuery(".messi-title",e.messi).append(e.options.title),0!==e.options.buttons.length||e.options.autoclose||e.options.closeButton&&(o=jQuery('<span class="messi-closebtn"></span>'),o.bind("click",function(){e.hide()}),jQuery(".messi-titlebox",this.messi).prepend(o)),null!==e.options.titleClass&&jQuery(".messi-titlebox",this.messi).addClass(e.options.titleClass)),null!==e.options.width&&jQuery(".messi-box",e.messi).css("width",e.options.width),e.options.buttons.length>0)for(var n=0;n<e.options.buttons.length;n++){var l=e.options.buttons[n]["class"]?e.options.buttons[n]["class"]:"",p='<button class="btn '+l+'" href="#">'+e.options.buttons[n].label+"</button>";p=jQuery('<div class="btnbox">'+p+"</div>",{}),p.data("value",e.options.buttons[n].val),jQuery(p).click(function(){var s=$(this).data("value");return"function"==typeof e.options.callback&&e.options.callback(s)===!1?this:void e.hide()}),jQuery(".messi-actions",this.messi).append(p)}else jQuery(".messi-footbox",this.messi).remove();return 0!==e.options.buttons.length||null!==e.options.title||e.options.autoclose||e.options.closeButton&&(o=jQuery('<span class="messi-closebtn"></span>'),o.bind("click",function(){e.hide()}),jQuery(".messi-content",this.messi).prepend(o)),e.modal=e.options.modal?jQuery('<div class="messi-modal"></div>').css({opacity:e.options.modalOpacity,width:jQuery(document).width(),height:jQuery(document).height(),"z-index":e.options.zIndex+jQuery(".messi").length}).appendTo(document.body):null,e.options.show&&e.show(),jQuery(window).bind("resize scroll",function(){e.resize()}),null!==e.options.autoclose&&setTimeout(function(){{var s=jQuery.data(this,"value");null!==e.options.callback?function(){e.options.callback(s)}:null}e.hide()},e.options.autoclose,this),e}s.prototype={options:{autoclose:null,buttons:[],callback:null,center:!0,closeButton:!0,height:"auto",title:null,titleClass:null,minMargin:15,modal:!1,modalOpacity:.2,padding:"10px",show:!0,unload:!0,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="messi"><div class="messi-box"><div class="messi-wrapper"><div class="messi-titlebox"><span class="messi-title"></span></div><div class="messi-content"></div><div class="messi-footbox"><div class="messi-actions"></div></div></div></div></div>',content:"<div></div>",visible:!1,setContent:function(s){jQuery(".messi-content",this.messi).css({padding:this.options.padding,height:this.options.height}).empty().append(s)},viewport:function(){return{top:(jQuery(window).height()-this.messi.height())/2+jQuery(window).scrollTop()+"px",left:(jQuery(window).width()-this.messi.width())/2+jQuery(window).scrollLeft()+"px"}},show:function(){this.visible||(0===this.messi.parent().length&&(this.modal&&this.modal.appendTo(document.body),this.messi.appendTo(document.body)),this.modal&&this.modal.show(),this.options.center?this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)):this.nudge(),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".messi").length}).show().animate({opacity:1},300),this.visible=!0)},hide:function(){if(this.visible){var s=this;return this.messi.animate({opacity:0},300,function(){s.modal&&s.modal.css({display:"none"}),s.messi.css({display:"none"}),s.visible=!1,s.options.unload&&s.unload()}),this}},resize:function(){this.options.modal&&jQuery(".messi-modal").css({width:jQuery(document).width(),height:jQuery(document).height()}),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left}))},toggle:function(){return this[this.visible?"hide":"show"](),this},unload:function(){this.visible&&this.hide(),jQuery(window).unbind("resize scroll"),this.modal&&this.modal.remove(),this.messi.remove()},nudge:function(){var s=jQuery(window),i=this.options.viewport.left.replace("px",""),t=this.options.viewport.top.replace("px","");if(this.isNumber(i)&&this.isNumber(t)){i=parseInt(i,10),t=parseInt(t,10);var o=jQuery(document).scrollLeft()+s.width()-this.messi.width()-this.options.minMargin;i>o&&(i-=this.messi.width()+2*this.options.minMargin),i=this.max(i,0),t+this.messi.height()>s.height()+jQuery(document).scrollTop()&&(t-=this.messi.height()+this.options.minMargin),this.options.viewport.left=i.toString()+"px",this.options.viewport.top=t.toString()+"px"}},max:function(s,i){return s>i?s:i},isNumber:function(s){return!isNaN(parseFloat(s))&&isFinite(s)}},window.Messi=s,jQuery.Messi=s}();