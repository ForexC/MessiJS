!function(t,s){function i(s,e){var o=this;if(o.options=jQuery.extend({},i.prototype.options,e||{}),o.messi=jQuery(o.template),o.setContent(s),null==o.options.title)jQuery(".messi-titlebox",o.messi).remove();else{if(jQuery(".messi-title",o.messi).append(o.options.title),0===o.options.buttons.length&&!o.options.autoclose&&o.options.closeButton){var n=jQuery('<span class="messi-closebtn"></span>');n.bind("click",function(){o.hide()}),jQuery(".messi-titlebox",this.messi).prepend(n)}null!=o.options.titleClass&&jQuery(".messi-titlebox",this.messi).addClass(o.options.titleClass)}if(null!=o.options.width&&jQuery(".messi-box",o.messi).css("width",o.options.width),o.options.buttons.length>0)for(var l=0;l<o.options.buttons.length;l++){var h=o.options.buttons[l]["class"]?o.options.buttons[l]["class"]:"",a=jQuery('<div class="btnbox"><button data-value="'+o.options.buttons[l].val+'" class="btn '+h+'" href="#">'+o.options.buttons[l].label+"</button></div>");a.on("click","button",function(){var t=jQuery(this).data("value"),s=null!=o.options.callback?function(){return o.options.callback.call(this,t)}:null;o.hide(s)}),jQuery(".messi-actions",this.messi).append(a)}else jQuery(".messi-footbox",this.messi).remove();if(0===o.options.buttons.length&&null==o.options.title&&!o.options.autoclose&&o.options.closeButton){var n=jQuery('<span class="messi-closebtn"></span>');n.bind("click",function(){o.hide()}),jQuery(".messi-content",this.messi).prepend(n)}return o.modal=o.options.modal?jQuery('<div class="messi-modal"></div>').css({opacity:o.options.modalOpacity,width:jQuery(document).width(),height:jQuery(document).height(),"z-index":o.options.zIndex+jQuery(".messi").length}).appendTo(document.body):null,o.options.show&&o.show(),jQuery(t).bind("resize scroll",function(){o.resize()}),null!=o.options.autoclose&&setTimeout(function(t){var s=jQuery.data(this,"value"),i=null!=t.options.callback?function(){t.options.callback(s)}:null;t.hide(i)},o.options.autoclose,this),o}i.prototype={options:{autoclose:null,buttons:[],callback:null,center:!0,closeButton:!0,height:"auto",title:null,titleClass:null,minMargin:15,modal:!1,modalOpacity:.2,padding:"10px",show:!0,unload:!0,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="messi"><div class="messi-box"><div class="messi-wrapper"><div class="messi-titlebox"><span class="messi-title"></span></div><div class="messi-content"></div><div class="messi-footbox"><div class="messi-actions"></div></div></div></div></div>',content:"<div></div>",visible:!1,setContent:function(t){jQuery(".messi-content",this.messi).css({padding:this.options.padding,height:this.options.height}).empty().append(t)},viewport:function(){return{top:(jQuery(t).height()-this.messi.height())/2+jQuery(t).scrollTop()+"px",left:(jQuery(t).width()-this.messi.width())/2+jQuery(t).scrollLeft()+"px"}},show:function(){this.visible||(0==this.messi.parent().length&&(this.modal&&this.modal.appendTo(document.body),this.messi.appendTo(document.body)),this.modal&&this.modal.show(),this.options.center?this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)):this.nudge(),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".messi").length}).show().animate({opacity:1},300),this.visible=!0)},hide:function(t){if(this.visible){var s=this;return"function"==typeof t&&0==t.call(this)?this:(this.messi.animate({opacity:0},300,function(){s.modal&&s.modal.css({display:"none"}),s.messi.css({display:"none"}),s.visible=!1,s.options.unload&&s.unload()}),this)}},resize:function(){this.options.modal&&jQuery(".messi-modal").css({width:jQuery(document).width(),height:jQuery(document).height()}),this.options.center&&(this.options.viewport=this.viewport(jQuery(".messi-box",this.messi)),this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left}))},toggle:function(){return this[this.visible?"hide":"show"](),this},unload:function(){this.visible&&this.hide(),jQuery(t).unbind("resize scroll",function(){this.resize()}),this.modal&&this.modal.remove(),this.messi.remove()},nudge:function(){var i=s(t),e=this.options.viewport.left.replace("px",""),o=this.options.viewport.top.replace("px","");if(this.isNumber(e)&&this.isNumber(o)){e=parseInt(e,10),o=parseInt(o,10);var n=s(document).scrollLeft()+i.width()-this.messi.width()-this.options.minMargin;e>n&&(e-=this.messi.width()+2*this.options.minMargin),e=this.max(e,0),o+this.messi.height()>i.height()+s(document).scrollTop()&&(o-=this.messi.height()+this.options.minMargin),this.options.viewport.left=e.toString()+"px",this.options.viewport.top=o.toString()+"px"}},max:function(t,s){return t>s?t:s},isNumber:function(t){return!isNaN(parseFloat(t))&&isFinite(t)}},jQuery.extend(i,{alert:function(t,s,e){var o=[{id:"ok",label:"OK",val:"OK"}];return e=jQuery.extend({closeButton:!1,buttons:o,callback:function(){}},e||{},{show:!0,unload:!0,callback:s}),new i(t,e)},ask:function(t,s,e){var o=[{id:"yes",label:"Yes",val:"Y","class":"btn-success"},{id:"no",label:"No",val:"N","class":"btn-danger"}];return e=jQuery.extend({closeButton:!1,modal:!0,buttons:o,callback:function(){}},e||{},{show:!0,unload:!0,callback:s}),new i(t,e)},img:function(s,e){var o=new Image;jQuery(o).load(function(){var s={width:jQuery(t).width()-50,height:jQuery(t).height()-50},n=this.width>s.width||this.height>s.height?Math.min(s.width/this.width,s.height/this.height):1;jQuery(o).css({width:this.width*n,height:this.height*n}),e=jQuery.extend(e||{},{show:!0,unload:!0,closeButton:!0,width:this.width*n,height:this.height*n,padding:0}),new i(o,e)}).error(function(){"object"==typeof t.console&&console.log("Error loading "+s)}).attr("src",s)},load:function(s,e){e=jQuery.extend(e||{},{show:!0,unload:!0,params:{}});var o={url:s,data:e.params,dataType:"html",cache:!1,error:function(s){"object"==typeof t.console&&console.log(s.responseText)},success:function(t){new i(t,e)}};jQuery.ajax(o)}}),t.Messi=i,s.Messi=i}(window,jQuery);